<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta  name="_csrf" th:content="${_csrf.token}"/>
    <meta  name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title>AmazonKindleStore.com</title>
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/custom.css}">
</head>
<body>
<div th:replace="~{fragments/navigation :: navigation}"></div>

<div class="publisher-name" th:text="${publisher.name}"></div>
<div class="publisher-about">
    <div class="publisher-logo" th:text="${publisher.name}"></div>
    <div class="publisher-description">
        <div class="about-the-publisher">About the publisher</div>
        <div class="description" th:text="${publisher.description}"></div>
    </div>
</div>

<div class="books-section" id="books-section">

    <div class="sorting-options">
        <div class="result-count" th:text="${startIndex} + '-' + ${endIndex} + ' of ' + ${numberOfBooks} + ' results'">
            Results Count
        </div>
        <select id="sortOptions" onchange="location = this.value">
            <option th:each="option : ${sortOptions.entrySet()}"
                    th:value="@{/publishers/{id}(id=${publisher.id}, page = 0, sortBy = ${option.key})}"
                    th:text="${option.value}"
                    th:selected="${currentSort == option.key}">
                Sort Option
            </option>
        </select>
    </div>


    <div th:replace="~{fragments/book-list :: book-list}"></div>


    <div class="pages-section" th:with="totalPages=${totalPages}, currentPage=${currentPage}">
        <nav aria-label="Page navigation">
            <ul class="pagination">
                <!-- Previous Page Link -->
                <li th:class="${currentPage == 0} ? 'page-item disabled' : 'page-item'">
                    <a class="page-link" th:href="${currentPage > 0} ? @{/publishers/{id}(id=${publisher.id}, 
                page=${currentPage - 1}, sortBy=${currentSort})} : '#'" aria-label="Previous">
                        <span>< Previous</span>
                    </a>
                </li>

                <!-- First Page Link -->
                <li th:if="${currentPage >= 1}" th:class="${currentPage >= 1} ? 'page-item' : 'page-item disabled'">
                    <a class="page-link" th:href="@{/publishers/{id}(id=${publisher.id}, 
                page=0, sortBy=${currentSort})}">1</a>
                </li>

                <!-- Ellipsis before current page range -->
                <li th:if="${currentPage - 1 >= 2}" class="page-item disabled">
                    <span class="page-link">...</span>
                </li>

                <!-- Page Numbers: Current Page - 1 -->
                <li th:if="${currentPage >= 2}" class="page-item">
                    <a class="page-link" th:href="@{/publishers/{id}(id=${publisher.id}, 
                page=${currentPage - 1}, sortBy=${currentSort})}" th:text="${currentPage}"></a>
                </li>

                <!-- Current Page -->
                <li class="page-item active">
                    <span class="page-link" th:text="${currentPage + 1}"></span>
                </li>

                <!-- Page Numbers: Current Page + 1 -->
                <li th:if="${currentPage + 1 < totalPages - 1}" class="page-item">
                    <a class="page-link" th:href="@{/publishers/{id}(id=${publisher.id}, 
                page=${currentPage + 1}, sortBy=${currentSort})}" th:text="${currentPage + 2}"></a>
                </li>

                <!-- Ellipsis after current page range -->
                <li th:if="${currentPage + 2 < totalPages - 1}" class="page-item disabled">
                    <span class="page-link">...</span>
                </li>

                <!-- Last Page Link -->
                <li th:if="${totalPages > 1} and ${currentPage + 2 <= totalPages}"
                    th:class="${currentPage + 1 == totalPages} ? 'page-item active' : 'page-item'">
                    <a class="page-link" th:href="@{/publishers/{id}(id=${publisher.id}, 
                page=${totalPages - 1}, sortBy=${currentSort})}" th:text="${totalPages}"></a>
                </li>

                <!-- Next Page Link -->
                <li th:class="${currentPage + 1 == totalPages} ? 'page-item disabled' : 'page-item'">
                    <a class="page-link" th:href="${currentPage + 1 < totalPages} ? 
                @{/publishers/{id}(id=${publisher.id}, page=${currentPage + 1}, sortBy=${currentSort})} : 
                '#'" aria-label="Next">
                        <span>Next ></span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>

</div>

<div th:replace="~{fragments/footer :: footer}"></div>

<script th:inline="javascript">
    let isLoggedIn = [[${isLoggedIn}]];
</script>
<script th:src="@{/javascript/bootstrap.min.js}"></script>
<script th:src="@{/javascript/app.js}"></script>
</body>
</html>